{"pageProps":{"frontmatter":{"id":1,"title":"SQL Self Join","date":"May 4 2020"},"slug":"sql-self-join","content":"<p>I recently learnt that SQL has the ability to join a table to itself, this is called a self-join. This is possible when you have a table which has a column referencing the primary key.</p>\n<p>Let’s say for example we have an employees table which looks something like this:</p>\n<table>\n<thead>\n<tr>\n<th>employee_id</th>\n<th>first_name</th>\n<th>last_name</th>\n<th>manager_id</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>Abraham</td>\n<td>Lincoln</td>\n<td></td>\n</tr>\n<tr>\n<td>2</td>\n<td>Benjamin</td>\n<td>Franklin</td>\n<td>1</td>\n</tr>\n<tr>\n<td>3</td>\n<td>Charlie</td>\n<td>Brown</td>\n<td>1</td>\n</tr>\n<tr>\n<td>4</td>\n<td>Douglas</td>\n<td>Greyling</td>\n<td>2</td>\n</tr>\n</tbody></table>\n<p>So, for this example, <code>employee_id</code> is our primary key for all of our employees. The employees table has another column, <code>manager_id</code>, which tracks whether, or not, this employee has a manager. No manager id could mean that this employee is the head honcho in charge, or that they are a manager who reports to another manager. Makes sense?</p>\n<p>Either way, we can do a self-join on this table to find all employees who have managers.</p>\n<pre><code class=\"language-sql\">SELECT e.first_name, e.last_name, m.first_name AS manager\nFROM employees e\nJOIN employees m\nON e.manager_id = m.employee_id;\n</code></pre>\n<p>Or to be more succinct:</p>\n<pre><code class=\"language-sql\">SELECT e.first_name, e.last_name, m.first_name AS manager\nFROM employees e, employees m\nWHERE e.manager_id = m.employee_id;\n</code></pre>\n<p>Our result should look something like this:</p>\n<table>\n<thead>\n<tr>\n<th>first_name</th>\n<th>last_name</th>\n<th>manager</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Benjamin</td>\n<td>Franklin</td>\n<td>Abraham</td>\n</tr>\n<tr>\n<td>Charlie</td>\n<td>Brown</td>\n<td>Abraham</td>\n</tr>\n<tr>\n<td>Douglas</td>\n<td>Greyling</td>\n<td>Benjamin</td>\n</tr>\n</tbody></table>\n<p>And that’s it. I knew about the concept of joins, but I didn’t realise that one could do a self-join. I thought this was pretty awesome!</p>\n"},"__N_SSG":true}